{"name":"Misc patches","tagline":"Patches for ViewVC and Trac for using mixed Japanese encodings.","body":"========================================================================\r\nviewvc の(ショートログ文字化け対策)パッチ\r\n========================================================================\r\n\r\n===================================================================================\r\n注意！ 以下のパッチは現在では必要ありません。詳細は、2011/09/03の追記をご覧ください\r\n===================================================================================\r\n\r\n======================\r\nこのパッチができること\r\n======================\r\n\r\nこのパッチを当てることで、shift_jis, euc-jp, iso2022_jp, utf-8 が混在する\r\nSubversionのリポジトリの文字化けが起きにくくなります．具体的には、\r\n\r\n  1. use_localtime=1にしたときの(Windowsバージョンでの)ディレクトリ画面の時間表示とログ\r\n  2. view と blame 画面\r\n  3. シンタックスハイライトをOnにしときの view, blame画面\r\n  4. diff 画面\r\n\r\nでの日本語の文字化けが改善されます．但し、side by side diff での日本語混在による\r\nカラムずれの対策はまだです...\r\n\r\nCVSのリポジトリに関しては未対策です．すいません...\r\n\r\n下にも書いたのですが、ごく小さいファイルで文字コードがEUCかUTF-8の場合、\r\nblameに失敗して、うまく変換できません。 blame の --force オプションに相当するものを\r\n探してみたのですが、c のソースコードにある、svn_client_blame3() を使うための\r\nsvn_diff_file_options_t をpythonから使うことができていない為、あきらめモードです...\r\nどなたか詳しい方、ご教示を... (ver.1.0.?では、コマンドラインのsvnをpipeで\r\n使っているので、--forceを挿入済み)\r\n\r\n * misc_patches/viewvc/1.1.0-beta/viewvc_all.patch は安定版用(ver.1.1.0-beta)('08/11/13追加 python2.5用)\r\n\r\n * misc_patches/viewvc/1.0.7/viewvc_all.patch は安定版用(ver.1.0.7)('08/11/04追加 python2.5用)\r\n\r\n * misc_patches/viewvc/1.0.5/viewvc_all.patch は安定版用(ver.1.0.5)('08/03/03追加,'08/11/13 python2.5用に修正)\r\n\r\n * misc_patches/viewvc/viewvc_all.patch がchardetを使用した開発版 ( rev.2047に対するパッチ．ver1.2-dev)\r\n\r\n * misc_patches/viewvc/viewvc_pykf_all.patch も開発版ですが、pykfを使用\r\n\r\n開発版で、pykf用のパッチを使う場合は、\r\nmisc_patches/pygments/lexer.patch (pygments用のパッチ)も必要です．\r\n\r\nchardetは、http://chardet.feedparser.org にあります.\r\n\r\nchardet用のパッチを当てた後で、やはり pykfにしたい場合は、\r\nmisc_patches/viewvc/forPykf/toutf8.py に置き換えて、 viewvc.py の \"chardet\" と書かれている\r\n部分(2カ所あります)を全て\"pykf\"に書き換えることで、pykfが使えるようになります．\r\n\r\nchardetを使わない場合は、pykf_ をインストールする必要があります． windows用のバイナリがあるのが嬉しいですね．\r\n\r\n\r\nああ，でも，ここのソースはヘッダファイルが足りないので，Linux等で使いたい人は\r\n\r\n`こちらの方`_ で提供されているtarballが良いようです．\r\n\r\n.. _`こちらの方`: http://memo.jj-net.jp/231\r\n\r\n注意\r\n====\r\n\r\nこのパッチは，ブラウザの表示関係については何もしていません．\r\n\r\nhttpd.conf等に\r\n\r\n::\r\n\r\n    AddDefaultCharset utf-8\r\n\r\n\r\nと書いておけば文字化けしないはずですが，standalone.pyを使う場合は template/header/header.eztの\r\n\r\nhead部分に\r\n\r\n::\r\n\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r\n\r\nと追加しておけばよいでしょう．\r\n\r\n追記(2011/09/03)\r\n----------------\r\n\r\n３年ぶりにviewvcのリポジトリをチェックしてみたところ、本家の方でchardetをつかった\r\n文字コード推定に対応していました。よかったよかった。\r\nこれは、ver.1.1.2から有効になっているようです。\r\nですので、trunkからの開発バージョンはもちろん、tarball/zipでダウンロードできる\r\nver.1.1.11でも可能となっています。\r\n但し、デフォルトでは無効になっているので、viewvc.confで、\r\n\r\n::\r\n\r\n    detect_encoding = 1\r\n\r\nとします。というわけで、ここのパッチはお役御免となったわけですが、\r\n\r\n::\r\n\r\n    short_log_len = 20\r\n\r\n\r\nなどとしていると、ログに日本語を使っている場合、日本語の途中で切ってしまうために\r\n文字化けすることがあります。これに対策するためのパッチを作りました。\r\n\r\n    * misc_patches/trunk/viewvc/viewvc.patch\r\n\r\nエラーが無くなるまで、文末から1バイトづつ減らしてはデコードしてみるという\r\nかなり強引な方法ですが...\r\n\r\n追記 (2008/11/04)\r\n-----------------\r\n\r\n * toutf8() を独立ファイルにしました。\r\n\r\n * python2.5に移行したので、コーデック名が前と違っています。2.4の場合は、以前のパッチを参考にして修正してください。\r\n\r\n * 小さいファイルで、文字コードがeucか、utf-8の場合、blameに失敗するために、うまく変換できないことがあります。\r\n\r\n追記 (2008/2/19)\r\n----------------\r\n\r\n * mod_python用のファイル名が，viewvc.py から viewvc_mp.py のように変更になっています(!r1799)．\r\n\r\n * mod_python を ver.3.3.1 にすると，viewvcがエラーを吐くようです． `こちらの方が`_ 対策されています．\r\n\r\n.. _`こちらの方が`:  http://jfut.featia.net/diary/20070610.html\r\n\r\n追記 (2008/3/6)\r\n---------------\r\n\r\n * リポジトリのディレクトリ構成を変更しました\r\n\r\n * リポジトリブラウザの最下部にある \"ことなるフォーマットでダウンロード\"からダウンロードすると、改行がLFのみになってしまうので、Windowsではパッチ当てに失敗するかもしれません。その時は改行記号を変えられるエディタでCR+LFに変更してみてください\r\n\r\n追記 (2008/3/19)\r\n----------------\r\n\r\n * 以下のパッチは、 [http://e.tir.jp/wiliki/viewcvs こちらの方]  が作成されたviewvcvs用のものがオリジナルです。Tracのパッチも、そのパッチを借用した形になっています。 (Trac移動時に抜けてしまいました。ごめんなさい。)\r\n\r\n * y-miyoさんによる追加修正を反映しました(ver.1.0.5のみ)。\r\n\r\n=========================================\r\ntrac の(日本語文字コード混在環境向)パッチ\r\n=========================================\r\n\r\nこのところWindowsのソフト開発でもコメントにUTF-8を使っていたので，\r\nTracのバージョンが上がって, パッチが無効になっていることに気づいていませんでした(!^_!^;;\r\n\r\nそんなわけで，久々にパッチを更新しました．trac 0.10.4用ですが，きっと0.10.3でもいけるでしょう．\r\n\r\nsvn:mime-type をちゃんと設定してあげれば，このパッチは不要なのですが，\r\nマルチな環境にまたがったプロジェクトだったりすると，文字コードが混在してしまって，\r\nそれをいちいちsvn:mim-typeで設定するのも大変かなあと．\r\n\r\nもっとも，先にも書いたように，僕自身はWindowsでもLinuxでもutf-8でソースコードを\r\n書くようになったので，それほど必要性を感じなくなってきたんですが...\r\n\r\n  * misc_patches/trunk/trac/api.patch は，trac/mimeview/api.py に対するパッチ，\r\n  * misc_patches/trunk/trac/text.patch は， trac/utils/text.py に対するパッチです．\r\n\r\npykf_ をインストールする必要があります．\r\n\r\n追記 (2010/10/1)\r\n================\r\n\r\nまたまた久々に、0.11 用と、0.12用のパッチを作成しました。\r\n\r\n  * misc_patches/trunk/trac/0.11/Trac-0.11.7.patch  が 0.11.7用\r\n  * misc_patches/trunk/trac/0.12/Trac-0.12.patch が 0.12用です。\r\n\r\n今回からパッチを一つにまとめました。以下のようにあててください。\r\n\r\n::\r\n\r\n    % patch -p1 < Trac-0.12.patch\r\n\r\n.. _pykf: http://sourceforge.jp/projects/pykf/files/\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}